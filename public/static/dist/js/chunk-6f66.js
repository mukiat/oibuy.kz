(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f66"],{2662:function(t,e,i){},2994:function(t,e,i){"use strict";i("68ef"),i("c0c2")},"2bdd":function(t,e,i){"use strict";var n=i("a142"),s=i("543e"),a=i("db78"),o=i("023d"),r=Object(n["j"])("list"),c=r[0],u=r[1],h=r[2];e["a"]=c({model:{prop:"loading"},props:{error:Boolean,loading:Boolean,finished:Boolean,errorText:String,loadingText:String,finishedText:String,immediateCheck:{type:Boolean,default:!0},offset:{type:Number,default:300},direction:{type:String,default:"down"}},mounted:function(){this.scroller=Object(o["c"])(this.$el),this.handler(!0),this.immediateCheck&&this.$nextTick(this.check)},destroyed:function(){this.handler(!1)},activated:function(){this.handler(!0)},deactivated:function(){this.handler(!1)},watch:{loading:function(){this.$nextTick(this.check)},finished:function(){this.$nextTick(this.check)}},methods:{check:function(){if(!(this.loading||this.finished||this.error)){var t=this.$el,e=this.scroller,i=Object(o["e"])(e);if(i&&"none"!==window.getComputedStyle(t).display&&null!==t.offsetParent){var n=this.offset,s=this.direction;a()&&(this.$emit("input",!0),this.$emit("load"))}}function a(){if(t===e){var a=Object(o["d"])(t);if("up"===s)return a<=n;var r=a+i;return e.scrollHeight-r<=n}if("up"===s)return Object(o["d"])(e)-Object(o["a"])(t)<=n;var c=Object(o["a"])(t)+Object(o["e"])(t)-Object(o["a"])(e);return c-i<=n}},clickErrorText:function(){this.$emit("update:error",!1),this.$nextTick(this.check)},handler:function(t){this.binded!==t&&(this.binded=t,(t?a["b"]:a["a"])(this.scroller,"scroll",this.check))}},render:function(t){return t("div",{class:u()},["down"===this.direction&&this.slots(),this.loading&&t("div",{class:u("loading"),key:"loading"},[this.slots("loading")||[t(s["a"],{class:u("loading-icon")}),t("span",{class:u("loading-text")},[this.loadingText||h("loading")])]]),this.finished&&this.finishedText&&t("div",{class:u("finished-text")},[this.finishedText]),this.error&&this.errorText&&t("div",{on:{click:this.clickErrorText},class:u("error-text")},[this.errorText]),"up"===this.direction&&this.slots()])}})},"42d1":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.dscLoading?i("div",{staticClass:"cloading",style:{height:t.clientHeight+"px"},on:{touchmove:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"cloading-mask"}),t._t("text",[t._m(0)])],2):t._e()},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cloading-main"},[n("img",{attrs:{src:i("f8b2")}})])}],a=i("88d8"),o=(i("7f7f"),i("ac1e"),i("543e")),r={props:["dscLoading"],data:function(){return{clientHeight:""}},components:Object(a["a"])({},o["a"].name,o["a"]),created:function(){},mounted:function(){this.clientHeight=document.documentElement.clientHeight},methods:{}},c=r,u=(i("a637"),i("2877")),h=Object(u["a"])(c,n,s,!1,null,"9a0469b6",null);h.options.__file="DscLoading.vue";e["a"]=h.exports},"6ab3":function(t,e,i){},a637:function(t,e,i){"use strict";var n=i("2662"),s=i.n(n);s.a},ac1e:function(t,e,i){"use strict";i("68ef")},c0c2:function(t,e,i){},c3a6:function(t,e,i){"use strict";i("68ef")},de32:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container-box",style:{height:t.ch+"px"}},[i("div",{attrs:{id:"container"}}),i("div",{staticClass:"list-box"},[i("div",{staticClass:"list_scroll_box"},[i("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[i("van-list",{attrs:{finished:t.finished,"finished-text":t.$t("lang.no_more")},on:{load:t.getPostList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.postList,function(e,n){return i("div",{key:e.phone,staticClass:"list_item",on:{click:function(e){t.changePost(n)}}},[n==t.currentIndex?i("van-icon",{attrs:{name:"checked",color:"#f92028",size:"2rem"}}):i("span",{staticClass:"item_checked_icon"}),i("div",{staticClass:"item-main"},[i("div",[i("span",[t._v(t._s(e.pick_up_point))]),i("span",[t._v(t._s(e.distance)+"km")])]),i("div",[t._v(t._s(t.$t("lang.post_address"))+": "+t._s(e.address))]),i("div",[t._v(t._s(t.$t("lang.label_tel"))+" "+t._s(e.phone))])])],1)}))],1)],1),i("div",{staticClass:"btn btn-submit box-flex",on:{click:t.usePost}},[t._v(t._s(t.$t("lang.post_use")))])]),i("DscLoading",{attrs:{dscLoading:t.dscLoading}})],1)},s=[],a=i("f210"),o=(i("96cf"),i("cb0c")),r=(i("e7e5"),i("d399")),c=(i("c3a6"),i("ad06")),u=(i("2994"),i("2bdd")),h=(i("68ef"),i("6ab3"),i("a142")),d=i("db78"),l=i("3875"),f=i("023d"),p=i("543e"),g=Object(h["j"])("pull-refresh"),v=g[0],m=g[1],b=g[2],_=["pulling","loosing","success"],x=v({mixins:[l["a"]],props:{disabled:Boolean,successText:String,pullingText:String,loosingText:String,loadingText:String,value:{type:Boolean,required:!0},successDuration:{type:Number,default:500},animationDuration:{type:Number,default:300},headHeight:{type:Number,default:50}},data:function(){return{status:"normal",height:0,duration:0}},computed:{untouchable:function(){return"loading"===this.status||"success"===this.status||this.disabled}},watch:{value:function(t){var e=this;this.duration=this.animationDuration,!t&&this.successText?(this.status="success",setTimeout(function(){e.setStatus(0)},this.successDuration)):this.setStatus(t?this.headHeight:0,t)}},mounted:function(){this.scrollEl=Object(f["c"])(this.$el)},methods:{onTouchStart:function(t){!this.untouchable&&this.getCeiling()&&(this.duration=0,this.touchStart(t))},onTouchMove:function(t){this.untouchable||(this.touchMove(t),!this.ceiling&&this.getCeiling()&&(this.duration=0,this.startY=t.touches[0].clientY,this.deltaY=0),this.ceiling&&this.deltaY>=0&&"vertical"===this.direction&&(this.setStatus(this.ease(this.deltaY)),Object(d["c"])(t)))},onTouchEnd:function(){!this.untouchable&&this.ceiling&&this.deltaY&&(this.duration=this.animationDuration,"loosing"===this.status?(this.setStatus(this.headHeight,!0),this.$emit("input",!0),this.$emit("refresh")):this.setStatus(0))},getCeiling:function(){return this.ceiling=0===Object(f["d"])(this.scrollEl),this.ceiling},ease:function(t){var e=this.headHeight;return t<e?t:t<2*e?Math.round(e+(t-e)/2):Math.round(1.5*e+(t-2*e)/4)},setStatus:function(t,e){this.height=t;var i=e?"loading":0===t?"normal":t<this.headHeight?"pulling":"loosing";i!==this.status&&(this.status=i)}},render:function(t){var e=this.status,i=this[e+"Text"]||b(e),n={transition:this.duration+"ms",transform:this.height?"translate3d(0,"+this.height+"px, 0)":""},s=this.slots(e)||[-1!==_.indexOf(e)&&t("div",{class:m("text")},[i]),"loading"===e&&t("div",{class:m("loading")},[t(p["a"]),t("span",[i])])];return t("div",{class:m()},[t("div",{class:m("track"),style:n,on:{touchstart:this.onTouchStart,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchEnd}},[t("div",{class:m("head")},[s]),this.slots()])])}}),y=i("2b0e"),$=i("4328"),k=i.n($),w=i("42d1");y["default"].use(x),y["default"].use(u["a"]),y["default"].use(c["a"]),y["default"].use(r["a"]);var L=window.AMap,T={components:{DscLoading:w["a"]},data:function(){return{postList:[],currentIndex:0,loading:!1,finished:!1,dscLoading:!0,refreshing:!1,page:1,showMap:!1,ch:0}},created:function(){this.ch=document.documentElement.clientHeight||document.body.clientHeight},methods:{initMap:function(){this.showMap=!0;var t=JSON.parse(sessionStorage.getItem("addressLngLat")),e=this.postList[0],i=e.lng,n=e.lat,s=new L.LngLat(i,n),a=new L.Map("container",{zoom:15,center:s,viewMode:"3D",resizeEnable:!0}),o=new L.Marker({position:new L.LngLat(t.lng,t.lat)});o.setLabel({offset:new L.Pixel(10,0),content:"<div class='marker_info_label'><div></div><span>".concat(this.$t("lang.post_shipping_address"),"</span></div>"),direction:"right"}),a.add(o),this.map=a,L.plugin(["AMap.ToolBar","AMap.Scale"],function(){a.addControl(new L.ToolBar),a.addControl(new L.Scale)}),this.dscLoading=!1,this.openInfoCart(this.postList[0])},openInfoCart:function(t){this.map.clearInfoWindow();var e=new L.LngLat(t.lng,t.lat),i=new L.Marker({position:e});this.map.add(i);var n='<div class="info_cart">\n                    <div class="info_top">\n                      <div>'.concat(t.pick_up_point,"</div>\n                      <div>").concat(this.$t("lang.post_address"),": ").concat(t.address,"</div>\n                      <div>").concat(this.$t("lang.label_tel")," ").concat(t.phone,'</div>\n                    </div>\n                    <div class="info_bottom">\n                      <span>').concat(this.$t("lang.post_distance_address"),": ").concat(t.distance,'km</span>\n                    </div>\n                    <div class="daosanjiao"></div>\n                  </div>'),s=new L.InfoWindow({autoMove:!0,isCustom:!0,content:n,offset:new L.Pixel(0,-33)});s.open(this.map,e)},getPostList:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.post("".concat(window.ROOT_URL,"api/cgroup/flow/postlist"),k.a.stringify({page:this.page,size:10}));case 2:if(e=t.sent,i=e.data.data.post_list,n=e.status,this.loading=!1,200==n){t.next=8;break}return t.abrupt("return",Object(r["a"])(this.$t("lang.post_msg_fail")));case 8:this.refreshing&&(this.postList=[],this.currentIndex=0,this.refreshing=!1),i.length<10?this.finished=!0:this.page++,this.postList=Object(a["a"])(this.postList).concat(Object(a["a"])(i)),this.showMap||this.initMap();case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),onRefresh:function(){this.finished=!1,this.showMap=!1,this.loading=!0,this.page=1,this.getPostList()},changePost:function(t){t!=this.currentIndex&&(this.currentIndex=t,this.openInfoCart(this.postList[t]))},usePost:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.dscLoading){t.next=2;break}return t.abrupt("return");case 2:return this.dscLoading=!0,e=this.postList[this.currentIndex].leader_id,t.next=6,this.$store.dispatch("setChangeConsignee",{leader_id:e});case 6:if(i=t.sent,n=i.status,this.dscLoading=!1,"success"==n){t.next=11;break}return t.abrupt("return",Object(r["a"])(this.$t("lang.post_server_busy")));case 11:this.$route.query&&(this.$route.query.rec_type?"supplier"==this.$route.query.rec_type?this.$router.push({name:this.$route.query.routerLink,query:{rec_type:this.$route.query.rec_type,rec_id:this.$route.query.rec_id,leader_id:e}}):this.$router.push({name:this.$route.query.routerLink,query:{rec_type:this.$route.query.rec_type,type_id:this.$route.query.type_id,team_id:this.$route.query.team_id,leader_id:e}}):"crowdfunding-checkout"==this.$route.query.routerLink?this.$router.push({name:this.$route.query.routerLink,query:{pid:this.$route.query.pid,id:this.$route.query.id,number:this.$route.query.number,leader_id:e}}):this.$router.push({name:this.$route.query.routerLink,query:{leader_id:e}}));case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},j=T,O=(i("f309"),i("2877")),C=Object(O["a"])(j,n,s,!1,null,"7f5681de",null);C.options.__file="CommunityPost.vue";e["default"]=C.exports},f016:function(t,e,i){},f210:function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function s(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(t){return n(t)||s(t)||a()}i.d(e,"a",function(){return o})},f309:function(t,e,i){"use strict";var n=i("f016"),s=i.n(n);s.a},f8b2:function(t,e,i){t.exports=i.p+"img/loading.gif"}}]);